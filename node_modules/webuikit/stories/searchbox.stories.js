import React, { useState } from "react";
import { storiesOf } from "@storybook/react";
import Searchbox from "Components/Searchbox";
import MenuItem from "Components/MenuItem";
import PropTypes from "prop-types";
import withDocs from "storybook-readme/with-docs";
import SearchboxReadme from "Components/Searchbox/README.md";
import Stack from "../src/helpers/story-stack";

storiesOf("Searchbox", module).add(
  "Introduction",
  withDocs(SearchboxReadme, () => {
    return (
      <Stack>
        <SearchboxWrapper />
        <SearchboxWrapper type="tag" />
        <SearchboxWrapper type="tag" tagType="red" />
      </Stack>
    );
  })
);

const result1 = [
  {
    leftIcon: "starEmpty",
    label: "Delhi",
    desc: "Delhi NCR, India",
    value: "Delhi"
  },
  {
    leftIcon: "starEmpty",
    desc: "Europe",
    label: "Denmark",
    value: "Denmark"
  },
  {
    leftIcon: "starEmpty",
    desc: "Colorado, United States of America",
    label: "Denver",
    value: "Denver"
  },
  {
    leftIcon: "starEmpty",
    label: "Dehradun",
    desc: "Uttarakhand, India",
    value: "Dehradun"
  }
];

const SearchboxWrapper = props => {
  const [result, setResult] = useState([]);
  const handleChange = () => {
    setTimeout(() => setResult(getRandomizedResult()), 1000);
  };
  const handleSelect = value => console.log(value);
  return (
    <Searchbox
      onChange={handleChange}
      onSelect={handleSelect}
      type={props.type}
      tagType={props.tagType}
      width={props.width}
    >
      {result.map(r => (
        <MenuItem
          key={r.value}
          leftIcon={r.leftIcon}
          label={r.label}
          desc={r.desc}
          value={r.value}
        />
      ))}
    </Searchbox>
  );
};

SearchboxWrapper.propTypes = {
  type: PropTypes.string,
  tagType: PropTypes.string,
  width: PropTypes.string
};

const getRandomizedResult = () => {
  let result = [];
  result.push(result1[getRandom()]);
  result.push(result1[getRandom()]);
  result.push(result1[getRandom()]);
  result.push(result1[getRandom()]);
  return result;
};

const getRandom = () => parseInt((Math.random() * 10) % 4);
